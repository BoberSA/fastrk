
'''Butcher Table for Verner's RK8(9)16 algorithm.
Original matlab code at:
https://github.com/USNavalResearchLaboratory/TrackerComponentLibrary/blob/master/Mathematical_Functions/Differential_Equations/RungeKStep.m
'''


def vf(a, b):
    return a + b * 6**0.5


A = [
     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [1/12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [1/27, 2/27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [1/24, 0, 1/8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [vf(4, 94)/375, 0, vf(-94, -84)/125, vf(328, 208)/375, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [vf(9, -1)/150, 0, 0, vf(312, 32)/1425, vf(69, 29)/570, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [vf(927, -347)/1250, 0, 0, vf(-16248, 7328)/9375, vf(-489, 179)/3750, vf(14268, -5798) / 9375, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [2/27, 0, 0, 0, 0, vf(16, -1)/54, vf(16, 1) / 54, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [19/256, 0, 0, 0, 0, vf(118, -23)/512, vf(118, 23) / 512, -9 / 256, 0, 0, 0, 0, 0, 0, 0, 0],
     [11/144, 0, 0, 0, 0, vf(266, -1)/864, vf(266, 1) / 864, -1 / 16, -8 / 27, 0, 0, 0, 0, 0, 0, 0],
     [vf(5034, -271)/61440, 0, 0, 0, 0, 0, vf(7859, -1626)/10240, vf(-2232, 813) / 20480, vf(-594, 271) / 960, vf(657, -813) / 5120, 0, 0, 0, 0, 0, 0],
     [vf(5996, -3794)/405, 0, 0, 0, 0, vf(-4342, -338)/9, vf(154922, -40458) / 135, vf(-4176, 3794) / 45, vf(-340864, 242816) / 405, vf(26304, -15176) / 45, -26624 / 81, 0, 0, 0, 0, 0],
     [vf(3793, 2168)/103680, 0, 0, 0, 0, vf(4042, 2263)/13824, vf(-231278, 40717) / 69120, vf(7947, -2168) / 11520, vf(1048, -542) / 405, vf(-1383, 542) / 720, 2624 / 1053, 3 / 1664, 0, 0, 0, 0],
     [-137/1296, 0, 0, 0, 0, vf(5642, -337)/864, vf(5642, 337) / 864, -299 / 48, 184 / 81, -44 / 9, -5120 / 1053, -11 / 468, 16 / 9, 0, 0, 0],
     [vf(33617, -2168)/518400, 0, 0, 0, 0, vf(-3846, 31)/13824, vf(155338, -52807) / 345600, vf(-12537, 2168) / 57600, vf(92, 542) / 2025, vf(-1797, -542) / 3600, 320 / 567, -1 / 1920, 4 / 105, 0, 0, 0],
     [vf(-36487, -30352)/279600, 0, 0, 0, 0, vf(-29666, -4499) / 7456, vf(2779182, -615973) / 186400, vf(-94329, 91056) / 93200, vf(-232192, 121408) / 17475, vf(101226, -22764) / 5825, -169984 / 9087, -87 / 30290, 492 / 1165, 0, 1260 / 233, 0]
 ]

c = [0, 1/12, 1/9, 1/6, vf(2, 2)/15, vf(6, 1)/15, vf(6, -1)/15, 2/3, 1/2, 1/3, 1/4, 4/3, 5/6, 1, 1/6, 1]

b_main = [103/1680, 0, 0, 0, 0, 0, 0, -27/140, 76/105, -201/280, 1024/1365, 3/7280, 12/35, 9/280, 0, 0]

b_subs = [23/525, 0, 0, 0, 0, 0, 0, 171/1400, 86/525, 93/280, -2048/6825, -3/18200, 39/175, 0, 9/25, 233/4200]

order = (8, 9)
